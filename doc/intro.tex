\chapter{Introduction}
This document describes the functionality of our loadable Linux kernel module 
rootkit written during the \textbf{Praktikum Rootkit Programming} at the 
\textbf{Technische Universität München}. The purpose of the rootkit is strictly 
educational and serves as an interesting object to teach kernel programming, 
data manipulation and function hooking. Due to the limited scope of this 
course, we imply the executing user to be able to load the module. The rootkit 
itself does not consist of a single module but of many smaller modules that are 
tailored to the specific assignment. However, during this document and for the 
sake simplicity, we will disregard this fragmentation. The module was written  in 
C'99 for the \textbf{Linux Kernel} \texttt{3.10.16}.

\section{Requirements and Dependencies}
The rootkit modules are implemented and tested for the Linux Kernel 
3.10.16.\\
To compile the modules, GCC and GNU Make are needed.

\section{Installation instructions}
\begin{description}
\item[Compile the module] \hfill\\
  \verb+# make+
\item[Insert the module] \hfill\\
  \verb+# insmod rootkit.ko [command line arguments]+\\
{\small For a detailed list of all command line arguments, see below.}
\item[Remove the module] \hfill\\
  \verb+# rmmod rootkit+   
\end{description}

\begin{subsubsection}{Command line arguments}
\label{sec:arg}
\begin{center}
\begin{tabularx}{\textwidth}{|l|X|X|}
\hline
Parameter & Description & Assignment\\\hline
\texttt{hide\_pid=xxx,...} & Hides process with PID xxx & 3 Process Hiding
\\ \hline
\texttt{tcp\_ports=xxx,...}& Hides sockets with TCP port number xxx& 6 Socket 
Hiding 
\\ \cline{1-2}
\texttt{udp\_ports=xxx,...}& Hides sockets with UDP port number xxx& \\ \hline
\texttt{port=xxx} & Port for network-keylogging&9 Key logging
\\ \cline{1-2}
\texttt{ip=xxx.xxx.xxx.xxx} & Target IP for network-keylogging& \\ \hline
\texttt{hidden\_ip\_str=xxx.xxx.xxx.xxx} & Hide packets from or to IP & 10 Packet Hiding
\\\hline
\texttt{allowed\_ip=xxx.xxx.xxx.xxx} & Allows connection from client with IP & 
11 Port Knocking
\\\cline{1-2}
\texttt{hidden\_port=xxxx} & Hides port xxxx & \\ \hline
\end{tabularx}
\end{center}
\end{subsubsection}

\section{File structure}
\begin{tabularx}{\textwidth}{|X|X|X|}
\hline
Filename & Description & Assignment \\ \hline
Makefile & The makefile used in this project.\newline Runs the kernel 
build routine and runs the sysmap.sh & All \\ \hline
sysmap.sh & Converts contents the /boot/System.map* file to a usable header 
file (sysmap.h) & All \\ \hline
main.c & Main source file of the rootkit & All \\ \hline
codehiding.\{c,h\} & . & 1 \\ \hline
commands.\{c,h\} & . &1 \\ \hline
\end{tabularx}
